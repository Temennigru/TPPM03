TODO:
1- remove protected members and reimplement in subclasses